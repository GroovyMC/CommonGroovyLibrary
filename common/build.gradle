plugins {
    id 'convention.shared'
    alias libs.plugins.mdg
    alias libs.plugins.architectury.loom
}

modsDotGroovy.multiplatform.expose()

configurations {
    commonJava {
        canBeResolved = false
        canBeConsumed = true
    }
    commonGroovy {
        canBeResolved = false
        canBeConsumed = true
    }
    commonResources {
        canBeResolved = false
        canBeConsumed = true
    }
}

loom {
    runConfigs.configureEach {
        ideConfigGenerated = false
    }
}

registrationUtils {
    projects {
        common {
            type 'common'
        }
    }
}

import net.fabricmc.loom.task.AbstractRemapJarTask
tasks.withType(AbstractRemapJarTask).each {
    it.targetNamespace = "named"
}

dependencies {
    mappings loom.layered() {
        officialMojangMappings()
        parchment("org.parchmentmc.data:parchment-${libs.versions.parchment.minecraft.get()}:${libs.versions.parchment.mappings.get()}@zip")
    }
    minecraft libs.minecraft
    modImplementation libs.fabric.loader

    compileOnlyApi libs.groovybundler
    compileOnlyApi libs.jankson
    compileOnlyApi libs.nightconfig.toml
}

artifacts {
    commonJava sourceSets.main.java.sourceDirectories.singleFile
    commonGroovy sourceSets.main.groovy.sourceDirectories.singleFile
    commonResources sourceSets.main.resources.sourceDirectories.singleFile
}
